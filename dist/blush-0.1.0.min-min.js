!function(t){"use strict";function e(t,e){var i,n=e[t],s=[];if("."===t?(n=e,i=!1):(s=t.split("."),i=!!(s.length-1)),i){var r,a=s.length,o=e;for(r=0;r<a;r++)o&&(o=o[s[r]]);n=o}return n||0===n||(n=""),n}var i={render:function(t,e,i){var n=this.compile(t);return n.render(e,i)},compile:function(t){var e=this.cache[t];return e||(e=new i.Scanner(t),this.cache[t]=e),e.compile(),e},delimiters:["{{","}}","}}}"],cache:{}};i.Scanner=function(t){this.template=t,this.disassemblies=[new i.Disassembly],this.cursor=0,this.delimiterIndex=0,this.compiled=!1,this.outOfRange=this.template.length+1},i.Scanner.prototype.compile=function(){if(!this.compiled){for(var t=this.outOfRange-1;this.cursor<t;)this.processToken();this.compiled=!0}},i.Scanner.prototype.processToken=function(){var t=this.template.slice(this.cursor),e=t.indexOf(i.delimiters[this.delimiterIndex]);this.extractNextToken(t,e),this.addToken(),this.advanceCursor(e),e>=0&&this.flipDelimiter(t)},i.Scanner.prototype.extractNextToken=function(t,e){void 0===e||e===-1?this.nextToken=t:this.nextToken=t.slice(0,e)},i.Scanner.prototype.addToken=function(){this.delimiterIndex>0?this.orchestrateDisassemblies():this.addText()},i.Scanner.prototype.advanceCursor=function(t){t>=0?this.cursor=this.cursor+i.delimiters[this.delimiterIndex].length+t:this.cursor=this.outOfRange},i.Scanner.prototype.addText=function(){this.disassembly().addText(this.nextToken)},i.Scanner.prototype.orchestrateDisassemblies=function(){var t=new i.Tag(this.nextToken),e=this.disassembly();2===t.type||3===t.type?this.startSection(t):4===t.type&&t.name===e.key?this.endSection():e.addTag(t)},i.Scanner.prototype.startSection=function(t){var e=new i.Disassembly(t.name);e.addTag(t),this.disassemblies.push(e)},i.Scanner.prototype.endSection=function(){var t=this.disassemblies.pop(),e=t.tags[0];t.tags=t.tags.slice(1),e.disassembly=t,this.disassembly().addTag(e)},i.Scanner.prototype.disassembly=function(){return this.disassemblies[this.disassemblies.length-1]},i.Scanner.prototype.delimiter=function(){return i.delimiters[this.delimiterIndex]},i.Scanner.prototype.flipDelimiter=function(t){2===this.delimiterIndex||1===this.delimiterIndex?this.delimiterIndex=0:this.delimiterIndex=1,1===this.delimiterIndex&&""===this.nextToken&&"{"===t[2]&&(this.delimiterIndex=2)},i.Scanner.prototype.render=function(t,e){this.compile(),t=t||{},e=e||{};var i,n=[],s=this.disassemblies.length;for(i=0;i<s;i++)n.push(this.disassemblies[i].render(t,e));return String.prototype.concat.apply("",n)},i.Disassembly=function(t){this.key=t,this.texts=[],this.tags=[]},i.Disassembly.prototype.addText=function(t){t.length&&this.texts.push(t)},i.Disassembly.prototype.addTag=function(t){t.index=this.texts.length,this.tags.push(t),this.texts.push("")},i.Disassembly.prototype.render=function(t,e){var i,n=this.texts.slice(0),s=this.tags.length;for(i=0;i<s;i++)this.substitute(n,this.tags[i],t,e);return String.prototype.concat.apply("",n)},i.Disassembly.prototype.substitute=function(t,e,i,n){t[e.index]=e.render(i,n)},i.Variable=function(t,e){this.key=t,this.view=e,this.value=e[t],"."===t&&(this.value=e)},i.Variable.prototype.evaluate=function(){return this.isComplexKey()&&this.nestedValue(),this.stripFalseyValues(),this.value},i.Variable.prototype.isComplexKey=function(){if("."===this.key)return!1;var t=this.key.split(".");return this.complexKey=t,!!(t.length-1)},i.Variable.prototype.nestedValue=function(){var t,e=this.complexKey.length,i=this.view;for(t=0;t<e;t++)i&&(i=i[this.complexKey[t]]);this.value=i},i.Variable.prototype.stripFalseyValues=function(){this.value||0===this.value||(this.value="")},i.Tag=function(t,e){this.index=e,this.name=t.replace(/\s/g,""),this.separateTypeFromName()},i.Tag.prototype.separateTypeFromName=function(){this.type=this.determineType(),6!==this.type&&(this.name=this.name.slice(1))},i.Tag.prototype.determineType=function(){return{">":1,"#":2,"^":3,"/":4,"{":5}[this.name[0]]||6},i.Tag.prototype.render=function(t,e){var i;return i=1===this.type?this.partial(t,e):2===this.type?this.section(t,e):3===this.type?this.antiSection(t,e):5===this.type?this.evaluation(t):this.escapedEvaluation(t)},i.Tag.prototype.evaluation=function(t){return e(this.name,t)},i.Tag.prototype.escapedEvaluation=function(t){var i=e(this.name,t);return this.escape(i)},i.Tag.prototype.partial=function(t,e){var n,s=e[this.name];return s&&(n=i.render(s,t,e)),n||""},i.Tag.prototype.sectionView=function(t,e){var i=this.evaluation(t,e);return!(Array.isArray(i)&&!i.length)&&i},i.Tag.prototype.section=function(t,e){var i=this.sectionView(t,e);if(!i)return"";var n;return n=Array.isArray(i)?this.renderArraySection(i,e):this.disassembly.render(i,e)},i.Tag.prototype.renderArraySection=function(t,e){var i,n=[],s=t.length;for(i=0;i<s;i++)n.push(this.disassembly.render(t[i],e));return String.prototype.concat.apply("",n)},i.Tag.prototype.antiSection=function(t,e){var i=this.sectionView(t,e);return i?"":this.disassembly.render(t,e)},i.Tag.prototype.escape=function(t){return t.toString&&(t=t.toString()),String(t).replace(i.Tag.escapeRegex,i.Tag.escape)},i.Tag.escapeRegex=/[&<>"'`=\/]/g,i.Tag.escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},i.Tag.escape=function(t){return i.Tag.escapeMap[t]},t.Mario=i}(this),function(t){"use strict";var e={};e.polyfills={},e.utils={},e.polyfills.arrayForEach=function(t){var e,i,n=this.length;for(e=0;e<n;e++)i=this[e],t(i,e,this)},Array.prototype.forEach=Array.prototype.forEach||e.polyfills.arrayForEach,e.polyfills.objectAssign=function(){var t,e,i,n=arguments[0];for(i=1;i<arguments.length;i++){t=arguments[i];for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e])}return n},Object.assign=Object.assign||e.polyfills.objectAssign,e.createConstructor=function(){var t=function t(){if(!(this instanceof t))throw new Error("This is a class, and cannot be called without the new keyword.");this._initialize.apply(this,arguments)};return t},e.BaseClass=e.createConstructor(),e.BaseClass.prototype._initialize=function(){this.initialize.apply(this,arguments)},e.BaseClass.prototype.initialize=function(){},e.BaseClass.extend=function t(){var i=this,n=e.createConstructor(),s=Array.prototype.slice.call(arguments);return s.unshift(i.prototype),s.unshift(n.prototype),Object.assign.apply(null,s),n.prototype.constructor=n,n.extend=t,n},e.utils.typeOf=function(t){var e=Object.prototype.toString.call(t),i=e.match(/\[object (.*)\]/);return i&&i[1]},["String","Array","Object","Date","Regex","Number","Function","Null","Undefined","Boolean"].forEach(function(t){e.utils["is"+t]=function(i){return e.utils.typeOf(i)===t}}),e.utils.isNil=function(t){return e.utils.isUndefined(t)||e.utils.isNull(t)},e.utils.camelize=function(t){return t.replace(/(_\w)/g,function(t){return t[1].toUpperCase()})},e.utils.escapeHTML=function(t){if(!e.utils.isString(t))return t;var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(t).replace(/[&<>"'`=\/]/g,function(t){return i[t]})},e.ViewModel=e.BaseClass.extend({_initialize:function(t){t=t||{};var e=t.app||{};this.data=e.data&&e.data(),this.initialize.apply(this,arguments)},json:function(){return new e.ViewModel.ExtractJSON(this).run()}},e.utils),e.ViewModel.ExtractJSON=e.BaseClass.extend({_initialize:function(t){this.json={},this.viewModel=t,this.data=t.data,this.attributes=t.attributes||[],this.unescapedAttributes=t.unescapedAttributes||[]},run:function(){return this.addEscapedAttributes(),this.json},addEscapedAttributes:function(){this.attributes.forEach(function(t){this.json[t]=this.escapedValueFor(t)}.bind(this))},escapedValueFor:function(t){var i=this.valueFor(t);return e.utils.escapeHTML(i)},valueFor:function(t){var i=e.utils.camelize(t),n=this.viewModel[t]||this.viewModel[i];return void 0!==n&&e.utils.isFunction(n)&&(n=n()),n||this.data[t]}}),e.View=e.BaseClass.extend({_initialize:function(t){t=t||{},this.app=t.app,this.dom=this.findDom(t)||document.createElement("div"),this.initialize.apply(this,arguments)},render:function(){var t=this.attachmentMethod(),e=this.renderTemplate();"append"===t?this.dom.innerHTML+=e:"replace"===t?this.dom.innerHTML=e:this.dom.innerHTML=e+this.dom.innerHTML},findDom:function(t){return new e.View.DomFinder(this.app,t.parent,this.parentSelector()).dom()},renderTemplate:function(){return Mario.render(this.template(),this.viewModel())},template:function(){return this.getFromApp("template")||this._defaultConfig.template},viewModel:function(){return this.getFromApp("viewModel")||this._defaultConfig.viewModel},parentSelector:function(){return this.getConfig("parentSelector")||this._defaultConfig.parentSelector},attachmentMethod:function(){return this.getConfig("attachmentMethod")||this._defaultConfig.attachmentMethod},resolveConfig:function(){this._config||(this.config&&e.utils.isFunction(this.config)?this._config=this.config():this.config?this._config=this.config:this._config={})},getFromApp:function(t){if(this.app){var e=this.getConfig("name");if(e)return this.app[t+"s"][e]}},getConfig:function(t){var e;return this.resolveConfig(),e=void 0!==this._config[t]?this._config[t]:this._defaultConfig[t]},_defaultConfig:{viewModel:{},template:"Template not found!",attachmentMethod:"append",parentSelector:void 0}}),e.View.DomFinder=e.BaseClass.extend({_initialize:function(t,e,i){this.app=t,this.parentDom=e,this.selector=i},parent:function(){return this.parentDom||this.app.dom},dom:function(){var t=this.parent();if(!this.selector)return t;var e=t.querySelector(this.selector);return e||t}})}(this);