{"version":3,"sources":["blush-0.1.0.min.js"],"names":["global","evaluate","key","view","isComplex","value","keys","split","length","i","temp","Mario","render","template","partials","scanner","this","compile","cache","Scanner","delimiters","disassemblies","Disassembly","cursor","delimiterIndex","compiled","outOfRange","prototype","processToken","tail","slice","nextTagLocation","indexOf","extractNextToken","addToken","advanceCursor","flipDelimiter","location","undefined","nextToken","orchestrateDisassemblies","addText","disassembly","tag","Tag","currentDisassembly","type","startSection","name","endSection","addTag","push","pop","baseTag","tags","delimiter","content","String","concat","apply","texts","text","index","tagLength","substitute","Variable","isComplexKey","nestedValue","stripFalseyValues","complexKey","replace","separateTypeFromName","determineType",">","#","^","/","{","rendered","partial","section","antiSection","evaluation","escapedEvaluation","escape","rendeded","sectionView","fullView","Array","isArray","renderArraySection","toString","escapeRegex","escapeMap","&","<","\"","'","`","=","Blush","polyfills","utils","arrayForEach","iterator","element","forEach","objectAssign","current","argumentIndex","target","arguments","hasOwnProperty","Object","assign","createConstructor","klass","Error","_initialize","BaseClass","initialize","extend","parentClass","childClass","extensions","call","unshift","constructor","typeOf","output","matches","match","isNil","isUndefined","isNull","camelize","word","g","toUpperCase","escapeHTML","isString","entityMap","s","ViewModel","opts","app","data","json","ExtractJSON","run","viewModel","attributes","unescapedAttributes","addEscapedAttributes","escapedValueFor","bind","valueFor","camelName","local","isFunction","View","dom","findDom","document","createElement","attachmentMethod","renderTemplate","innerHTML","DomFinder","parent","parentSelector","getFromApp","_defaultConfig","getConfig","resolveConfig","_config","config","parentDom","selector","found","querySelector"],"mappings":"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","file":"blush-0.1.0.min.js","sourcesContent":["(function(global) {\n    'use strict';\n    var Mario = {\n        render: function(template, view, partials) {\n            var scanner = this.compile(template);\n            return scanner.render(view, partials);\n        },\n\n        compile: function(template) {\n            var scanner = this.cache[template];\n            if (!scanner) {\n                scanner = new Mario.Scanner(template);\n                this.cache[template] = scanner;\n            }\n            scanner.compile();\n            return scanner;\n        },\n\n        delimiters: ['{{', '}}', '}}}'],\n        cache: {}\n    };\n\n    Mario.Scanner = function(template) {\n        this.template = template;\n        this.disassemblies = [new Mario.Disassembly()];\n\n        this.cursor = 0;\n        this.delimiterIndex = 0;\n        this.compiled = false;\n        this.outOfRange = this.template.length + 1;\n    };\n\n    Mario.Scanner.prototype.compile = function compile() {\n        if (this.compiled) {\n            return;\n        }\n\n        var length = this.outOfRange - 1;\n        while (this.cursor < length) {\n            this.processToken();\n        }\n\n        this.compiled = true;\n    };\n\n    Mario.Scanner.prototype.processToken = function processToken() {\n        var tail = this.template.slice(this.cursor);\n        var nextTagLocation = tail.indexOf(Mario.delimiters[this.delimiterIndex]);\n\n        this.extractNextToken(tail, nextTagLocation);\n        this.addToken();\n        this.advanceCursor(nextTagLocation);\n\n        if (nextTagLocation >= 0) {\n            this.flipDelimiter(tail);\n        }\n    };\n\n    Mario.Scanner.prototype.extractNextToken = function extractNextToken(tail, location) {\n        if (location === undefined || location === -1) {\n            this.nextToken = tail;\n        } else {\n            this.nextToken = tail.slice(0, location);\n        }\n    };\n\n    Mario.Scanner.prototype.addToken = function addToken() {\n        if (this.delimiterIndex > 0) { // start of tag found, seeking ending\n            this.orchestrateDisassemblies();\n        } else {\n            this.addText();\n        }\n    };\n\n    Mario.Scanner.prototype.advanceCursor = function advanceCursor(nextTagLocation) {\n        if (nextTagLocation >= 0) {\n            this.cursor = this.cursor + Mario.delimiters[this.delimiterIndex].length + nextTagLocation;\n        } else {\n            this.cursor = this.outOfRange;\n        }\n    };\n\n    Mario.Scanner.prototype.addText = function() {\n        this.disassembly().addText(this.nextToken);\n    };\n\n    Mario.Scanner.prototype.orchestrateDisassemblies = function orchestrateDisassemblies() {\n        var tag = new Mario.Tag(this.nextToken);\n        var currentDisassembly = this.disassembly();\n        if (tag.type === 2 || tag.type === 3) {\n            this.startSection(tag);\n        } else if (tag.type === 4 && tag.name === currentDisassembly.key) {\n            this.endSection();\n        } else {\n            currentDisassembly.addTag(tag);\n        }\n    };\n\n    Mario.Scanner.prototype.startSection = function startSection(tag) {\n        var disassembly = new Mario.Disassembly(tag.name);\n        disassembly.addTag(tag);\n        this.disassemblies.push(disassembly);\n    };\n\n    Mario.Scanner.prototype.endSection = function endSection() {\n        var disassembly = this.disassemblies.pop();\n        var baseTag = disassembly.tags[0];\n        disassembly.tags = disassembly.tags.slice(1);\n        baseTag.disassembly = disassembly;\n        this.disassembly().addTag(baseTag);\n    };\n\n    Mario.Scanner.prototype.disassembly = function disassembly() {\n        return this.disassemblies[this.disassemblies.length - 1];\n    };\n\n    Mario.Scanner.prototype.delimiter = function delimiter() {\n        return Mario.delimiters[this.delimiterIndex];\n    };\n\n    Mario.Scanner.prototype.flipDelimiter = function flipDelimiter(tail) {\n        if (this.delimiterIndex === 2 || this.delimiterIndex === 1) {\n            this.delimiterIndex = 0;\n        } else {\n            this.delimiterIndex = 1;\n        }\n\n        if (this.delimiterIndex === 1 && this.nextToken === '' && tail[2] === '{') {\n            this.delimiterIndex = 2;\n        }\n    };\n\n    Mario.Scanner.prototype.render = function render(view, partials) {\n        this.compile();\n        view = view || {};\n        partials = partials || {};\n        var content = [];\n        var length = this.disassemblies.length;\n        var i;\n        for (i = 0; i < length; i++) {\n            content.push(this.disassemblies[i].render(view, partials));\n        }\n        return String.prototype.concat.apply('', content);\n    };\n\n    Mario.Disassembly = function(key) {\n        this.key = key;\n        this.texts = [];\n        this.tags = [];\n    };\n\n    Mario.Disassembly.prototype.addText = function addText(text) {\n        if (text.length) {\n            this.texts.push(text);\n        }\n    };\n\n    Mario.Disassembly.prototype.addTag = function addTag(tag) {\n        tag.index = this.texts.length;\n        this.tags.push(tag);\n        this.texts.push('');\n    };\n\n    Mario.Disassembly.prototype.render = function renderDisassembly(view, partials) {\n        var content = this.texts.slice(0);\n        var tagLength = this.tags.length;\n        var i;\n        for (i = 0; i < tagLength; i++) {\n            this.substitute(content, this.tags[i], view, partials);\n        }\n        return String.prototype.concat.apply('', content);\n    };\n\n    Mario.Disassembly.prototype.substitute = function substituteTagContent(content, tag, view, partials) {\n        content[tag.index] = tag.render(view, partials);\n    };\n\n    Mario.Variable = function(key, view) {\n        this.key = key;\n        this.view = view;\n        this.value = view[key];\n        if (key === '.') {\n            this.value = view;\n        }\n    };\n\n    Mario.Variable.prototype.evaluate = function evaluate() {\n        if (this.isComplexKey()) {\n            this.nestedValue();\n        }\n        this.stripFalseyValues();\n        return this.value;\n    };\n\n    Mario.Variable.prototype.isComplexKey = function isComplexKey() {\n        if (this.key === '.') {\n            return false;\n        }\n        var keys = this.key.split('.');\n        this.complexKey = keys;\n        return keys.length - 1 ? true : false;\n    };\n\n    Mario.Variable.prototype.nestedValue = function nestedValue() {\n        var length = this.complexKey.length;\n        var i;\n        var temp = this.view;\n        for (i = 0; i < length; i++) {\n            if (temp) {\n                temp = temp[this.complexKey[i]];\n            }\n        }\n        this.value = temp;\n    };\n\n    Mario.Variable.prototype.stripFalseyValues = function stripFalseyValues() {\n        if (!this.value && this.value !== 0) {\n            this.value = '';\n        }\n    };\n\n    function evaluate(key, view) {\n        var value = view[key];\n        var isComplex;\n        var keys = [];\n\n        if (key === '.') {\n            value = view;\n            isComplex = false;\n        } else {\n            keys = key.split('.');\n            isComplex = keys.length - 1 ? true : false;\n        }\n\n        if (isComplex) {\n            var length = keys.length;\n            var i;\n            var temp = view;\n            for (i = 0; i < length; i++) {\n                if (temp) {\n                    temp = temp[keys[i]];\n                }\n            }\n            value = temp;\n        }\n\n        if (!value && value !== 0) {\n            value = '';\n        }\n        return value;\n    }\n\n    Mario.Tag = function(name, index) {\n        this.index = index;\n        this.name = name.replace(/\\s/g, '');\n        this.separateTypeFromName();\n    };\n\n    Mario.Tag.prototype.separateTypeFromName = function separateTypeFromName() {\n        this.type = this.determineType();\n        if (this.type !== 6) {\n            this.name = this.name.slice(1);\n        }\n    };\n\n    Mario.Tag.prototype.determineType = function determineType() {\n        return {\n            '>': 1,\n            '#': 2,\n            '^': 3,\n            '/': 4,\n            '{': 5\n        }[this.name[0]] || 6;\n    };\n\n    Mario.Tag.prototype.render = function renderTag(view, partials) {\n        var rendered;\n        if (this.type === 1) {\n            rendered = this.partial(view, partials);\n        } else if (this.type === 2) {\n            rendered = this.section(view, partials);\n        } else if (this.type === 3) {\n            rendered = this.antiSection(view, partials);\n        } else if (this.type === 5) {\n            rendered = this.evaluation(view);\n        } else {\n            rendered = this.escapedEvaluation(view);\n        }\n        return rendered;\n    };\n\n    Mario.Tag.prototype.evaluation = function evaluation(view) {\n        //return new Mario.Variable(this.name, view).evaluate();\n        return evaluate(this.name, view);\n    };\n\n    Mario.Tag.prototype.escapedEvaluation = function escapedEvaluation(view) {\n        //var value = new Mario.Variable(this.name, view).evaluate();\n        var value = evaluate(this.name, view);\n        return this.escape(value);\n    };\n\n    Mario.Tag.prototype.partial = function renderPartial(view, partials) {\n        var partial = partials[this.name];\n        var rendeded;\n        if (partial) {\n            rendeded = Mario.render(partial, view, partials);\n        }\n        return rendeded || '';\n    };\n\n    Mario.Tag.prototype.sectionView = function sectionView(fullView, partials) {\n        var view = this.evaluation(fullView, partials);\n        if (Array.isArray(view) && !view.length) {\n            return false;\n        }\n        return view;\n    };\n\n    Mario.Tag.prototype.section = function renderSection(fullView, partials) {\n        var view = this.sectionView(fullView, partials);\n        if (!view) {\n            return '';\n        }\n        var content;\n        if (Array.isArray(view)) {\n            content = this.renderArraySection(view, partials);\n        } else {\n            content = this.disassembly.render(view, partials);\n        }\n        return content;\n    };\n\n    Mario.Tag.prototype.renderArraySection = function renderArraySection(view, partials) {\n        var content = [];\n        var length = view.length;\n        var i;\n        for (i = 0; i < length; i++) {\n            content.push(this.disassembly.render(view[i], partials));\n        }\n        return String.prototype.concat.apply('', content);\n    };\n\n    Mario.Tag.prototype.antiSection = function renderAntiSection(fullView, partials) {\n        var view = this.sectionView(fullView, partials);\n        if (view) {\n            return '';\n        }\n        return this.disassembly.render(fullView, partials);\n    };\n\n    // Stolen mostly from Mustache.js!\n    Mario.Tag.prototype.escape = function escapeHTML(value) {\n        if (value.toString) {\n            value = value.toString();\n        }\n\n        return String(value).replace(Mario.Tag.escapeRegex, Mario.Tag.escape);\n    };\n\n    Mario.Tag.escapeRegex = /[&<>\"'`=\\/]/g;\n    Mario.Tag.escapeMap = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        '\\'': '&#39;',\n        '/': '&#x2F;',\n        '`': '&#x60;',\n        '=': '&#x3D;'\n    };\n    Mario.Tag.escape = function escape(value) {\n        return Mario.Tag.escapeMap[value];\n    };\n\n    global.Mario = Mario;\n})(this);\n(function(global) {\n    'use strict';\n    var Blush = {};\n    Blush.polyfills = {};\n    Blush.utils = {};\n\n    Blush.polyfills.arrayForEach = function arrayForEach(iterator) {\n        var length = this.length;\n        var i, element;\n        for (i = 0; i < length; i++) {\n            element = this[i];\n            iterator(element, i, this);\n        }\n    };\n\n    Array.prototype.forEach = Array.prototype.forEach || Blush.polyfills.arrayForEach;\n\n    Blush.polyfills.objectAssign = function() {\n        var target = arguments[0];\n        var current, key, argumentIndex;\n\n        for (argumentIndex = 1; argumentIndex < arguments.length; argumentIndex++) {\n            current = arguments[argumentIndex];\n            for (key in current) {\n                if (current.hasOwnProperty(key)) {\n                    target[key] = current[key];\n                }\n            }\n        }\n\n        return target;\n    };\n\n    Object.assign = Object.assign || Blush.polyfills.objectAssign;\n\n    Blush.createConstructor = function() {\n        var klass = function klass() {\n            if (!(this instanceof klass)) {\n                throw new Error('This is a class, and cannot be called without the new keyword.');\n            }\n            this._initialize.apply(this, arguments);\n        };\n        return klass;\n    };\n\n    Blush.BaseClass = Blush.createConstructor();\n\n    Blush.BaseClass.prototype._initialize = function() {\n        this.initialize.apply(this, arguments);\n    };\n\n    Blush.BaseClass.prototype.initialize = function() {};\n\n    Blush.BaseClass.extend = function extend() {\n        var parentClass = this;\n        var childClass = Blush.createConstructor();\n        var extensions = Array.prototype.slice.call(arguments);\n        extensions.unshift(parentClass.prototype);\n        extensions.unshift(childClass.prototype);\n        Object.assign.apply(null, extensions);\n        childClass.prototype.constructor = childClass;\n        childClass.extend = extend;\n        return childClass;\n    };\n\n    Blush.utils.typeOf = function typeOf(value) {\n        var output = Object.prototype.toString.call(value);\n        var matches = output.match(/\\[object (.*)\\]/);\n        return matches && matches[1];\n    };\n\n    ['String', 'Array', 'Object', 'Date', 'Regex', 'Number', 'Function', 'Null', 'Undefined', 'Boolean'].forEach(function(type) {\n        Blush.utils['is' + type] = function isA(value) {\n            return Blush.utils.typeOf(value) === type;\n        };\n    });\n\n    Blush.utils.isNil = function isNil(value) {\n        return Blush.utils.isUndefined(value) || Blush.utils.isNull(value);\n    };\n\n    Blush.utils.camelize = function camelize(word) {\n        return word.replace(/(_\\w)/g, function(g) {\n            return g[1].toUpperCase();\n        });\n    };\n\n    Blush.utils.escapeHTML = function escapeHTML(text) {\n        if (!Blush.utils.isString(text)) {\n            return text;\n        }\n\n        var entityMap = {\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;',\n            '\"': '&quot;',\n            \"'\": '&#39;',\n            '/': '&#x2F;',\n            '`': '&#x60;',\n            '=': '&#x3D;'\n        };\n\n        return String(text).replace(/[&<>\"'`=\\/]/g, function fromEntityMap(s) {\n            return entityMap[s];\n        });\n    };\n\n    Blush.ViewModel = Blush.BaseClass.extend({\n        _initialize: function(opts) {\n            opts = opts || {};\n            var app = opts.app || {};\n            this.data = app.data && app.data();\n            this.initialize.apply(this, arguments);\n        },\n\n        json: function() {\n            return new Blush.ViewModel.ExtractJSON(this).run();\n        }\n    }, Blush.utils);\n\n    Blush.ViewModel.ExtractJSON = Blush.BaseClass.extend({\n        _initialize: function(viewModel) {\n            this.json = {};\n            this.viewModel = viewModel;\n            this.data = viewModel.data;\n            this.attributes = viewModel.attributes || [];\n            this.unescapedAttributes = viewModel.unescapedAttributes || [];\n        },\n\n        run: function() {\n            this.addEscapedAttributes();\n            //this.addUnescapedAttributes();\n            return this.json;\n        },\n\n        addEscapedAttributes: function() {\n            this.attributes.forEach(function(name) {\n                this.json[name] = this.escapedValueFor(name);\n            }.bind(this));\n        },\n\n        escapedValueFor: function(name) {\n            var value = this.valueFor(name);\n            return Blush.utils.escapeHTML(value);\n        },\n\n        valueFor: function(name) {\n            var camelName = Blush.utils.camelize(name);\n            var local = this.viewModel[name] || this.viewModel[camelName];\n            if (local !== undefined && Blush.utils.isFunction(local)) {\n                local = local();\n            }\n            return local || this.data[name];\n        }\n    });\n\n    Blush.View = Blush.BaseClass.extend({\n        _initialize: function(opts) {\n            opts = opts || {};\n            this.app = opts.app;\n            this.dom = this.findDom(opts) || document.createElement('div');\n            this.initialize.apply(this, arguments);\n        },\n\n        render: function() {\n            var attachmentMethod = this.attachmentMethod();\n            var rendered = this.renderTemplate();\n            // TODO: switch to more efficient if test \n            // View.attachmentType.APPEND = 0; // etc\n            if (attachmentMethod === 'append') {\n                this.dom.innerHTML += rendered;\n            } else if (attachmentMethod === 'replace') {\n                this.dom.innerHTML = rendered;\n            } else {\n                this.dom.innerHTML = rendered + this.dom.innerHTML;\n            }\n        },\n\n        findDom: function(opts) {\n            return new Blush.View.DomFinder(this.app, opts.parent, this.parentSelector()).dom();\n        },\n\n        renderTemplate: function() {\n            return Mario.render(this.template(), this.viewModel());\n        },\n\n        template: function() {\n            return this.getFromApp('template') || this._defaultConfig['template'];\n        },\n\n        viewModel: function() {\n            return this.getFromApp('viewModel') || this._defaultConfig['viewModel'];\n        },\n\n        parentSelector: function() {\n            return this.getConfig('parentSelector') || this._defaultConfig['parentSelector'];\n        },\n\n        attachmentMethod: function() {\n            return this.getConfig('attachmentMethod') || this._defaultConfig['attachmentMethod'];\n        },\n\n        resolveConfig: function() {\n            if (this._config) {\n                return;\n            }\n\n            if (this.config && Blush.utils.isFunction(this.config)) {\n                this._config = this.config();\n            } else if (this.config) {\n                this._config = this.config;\n            } else {\n                this._config = {};\n            }\n        },\n\n        getFromApp: function(key) {\n            if (!this.app) {\n                return;\n            }\n            var name = this.getConfig('name');\n            if (!name) {\n                return;\n            }\n            return this.app[key + 's'][name];\n        },\n\n        getConfig: function(type) {\n            var value;\n\n            this.resolveConfig();\n\n            if (this._config[type] !== undefined) {\n                value = this._config[type];\n            } else {\n                value = this._defaultConfig[type];\n            }\n\n            return value;\n        },\n\n        _defaultConfig: {\n            viewModel: {},\n            template: 'Template not found!',\n            attachmentMethod: 'append', // prepend, or replace\n            parentSelector: undefined\n        }\n    });\n\n    Blush.View.DomFinder = Blush.BaseClass.extend({\n        _initialize: function(app, parentDom, selector) {\n            this.app = app;\n            this.parentDom = parentDom;\n            this.selector = selector;\n        },\n\n        parent: function() {\n            return this.parentDom || this.app.dom;\n        },\n\n        dom: function() {\n            var parent = this.parent();\n            if (!this.selector) {\n                return parent;\n            }\n            var found = parent.querySelector(this.selector);\n            return found || parent;\n        }\n    });\n\n})(this);"]}